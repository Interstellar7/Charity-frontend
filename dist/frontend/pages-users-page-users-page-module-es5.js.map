{"version":3,"sources":["webpack:///src/app/features/users/guards/users-page.guard.ts","webpack:///src/app/pages/users-page/pages/user-list-page/user-list-page.component.ts","webpack:///src/app/pages/users-page/pages/user-list-page/user-list-page.component.html","webpack:///src/app/pages/users-page/pages/user-view-page/user-view-page.component.ts","webpack:///src/app/pages/users-page/pages/user-view-page/user-view-page.component.html","webpack:///src/app/pages/users-page/users-page-routing.module.ts","webpack:///src/app/pages/users-page/users-page.module.ts"],"names":["UsersPageGuard","currentUserService","router","next","state","hasRole","ADMIN","pipe","can","createUrlTree","providedIn","UserListPageComponent","userService","dialogService","refresh$","users$","getUsers","refreshUsers","open","afterClosed","subscribe","clickCreateUser","selector","templateUrl","styleUrls","UserViewPageComponent","routes","path","canActivate","children","pathMatch","component","UsersPageRoutingModule","forChild","imports","exports","UsersPageModule","declarations"],"mappings":"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","file":"pages-users-page-users-page-module-es5.js","sourcesContent":["import {Injectable} from '@angular/core';\r\nimport {ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot, UrlTree} from '@angular/router';\r\nimport {Observable} from 'rxjs';\r\nimport {CurrentUserService} from \"../../../core/services/current-user.service\";\r\nimport {Role} from \"../../../core/models/current-user.model\";\r\nimport {map} from \"rxjs/operators\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class UsersPageGuard implements CanActivate {\r\n\r\n  constructor(private currentUserService: CurrentUserService, private router: Router) {\r\n  }\r\n\r\n  canActivate(\r\n    next: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\r\n    return this.currentUserService.hasRole(Role.ADMIN).pipe(\r\n      map(can => {\r\n        if (can) {\r\n          return true;\r\n        }\r\n        return this.router.createUrlTree(['/']);\r\n      })\r\n    );\r\n  }\r\n\r\n}\r\n","import {Component, OnChanges, OnInit, SimpleChanges} from '@angular/core';\r\nimport {UserModel} from \"../../../../features/users/models/user.model\";\r\nimport {combineLatest, Observable, ReplaySubject} from \"rxjs\";\r\nimport {UserService} from \"../../../../features/users/services/user.service\";\r\nimport {MatDialog} from \"@angular/material/dialog\";\r\nimport {UserCreateDialogComponent} from \"../../../../features/users/components/user-create-dialog/user-create-dialog.component\";\r\nimport {map, switchMap} from \"rxjs/operators\";\r\n\r\n@Component({\r\n  selector: 'app-users-page',\r\n  templateUrl: './user-list-page.component.html',\r\n  styleUrls: ['./user-list-page.component.css']\r\n})\r\nexport class UserListPageComponent implements OnInit {\r\n\r\n  users?: UserModel[];\r\n\r\n  selectedUser?: UserModel;\r\n\r\n  users$!: Observable<UserModel[]>;\r\n\r\n  private refresh$ = new ReplaySubject<void>(1);\r\n\r\n  constructor(private userService: UserService, private dialogService: MatDialog) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.users$ = combineLatest([this.refresh$]).pipe(\r\n      switchMap(() => this.userService.getUsers())\r\n    );\r\n    this.refreshUsers();\r\n  }\r\n\r\n  refreshUsers() {\r\n    this.refresh$.next();\r\n  }\r\n\r\n  clickCreateUser() {\r\n    this.dialogService.open(UserCreateDialogComponent)\r\n      .afterClosed()\r\n      .subscribe(() => {\r\n        this.refreshUsers();\r\n      });\r\n  }\r\n}\r\n","<div class=\"page-header\">\r\n    <h1>User list</h1>\r\n    <div class=\"fill\"></div>\r\n    <button mat-raised-button color=\"primary\" (click)=\"clickCreateUser()\">+ Create user</button>\r\n</div>\r\n\r\n<app-users-table [users]=\"users$ | async\"\r\n                 [(selectedUser)]=\"selectedUser\"\r\n                  (refresh)=\"refreshUsers()\">\r\n</app-users-table>\r\n","import {Component, OnInit} from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-users-page',\r\n  templateUrl: './user-view-page.component.html',\r\n  styleUrls: ['./user-view-page.component.css']\r\n})\r\nexport class UserViewPageComponent implements OnInit {\r\n\r\n  constructor() {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<h1>User view</h1>\r\n","import {NgModule} from '@angular/core';\r\nimport {RouterModule, Routes} from '@angular/router';\r\nimport {UserListPageComponent} from \"./pages/user-list-page/user-list-page.component\";\r\nimport {UserViewPageComponent} from \"./pages/user-view-page/user-view-page.component\";\r\nimport {UsersPageGuard} from \"../../features/users/guards/users-page.guard\";\r\n\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    canActivate: [UsersPageGuard],\r\n    children: [\r\n      {\r\n        path: '',\r\n        pathMatch: 'full',\r\n        component: UserListPageComponent\r\n      },\r\n      {\r\n        path: ':id',\r\n        component: UserViewPageComponent\r\n      }\r\n    ]\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class UsersPageRoutingModule {\r\n}\r\n","import {NgModule} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {UsersPageRoutingModule} from './users-page-routing.module';\r\nimport {UserViewPageComponent} from './pages/user-view-page/user-view-page.component';\r\nimport {UserListPageComponent} from \"./pages/user-list-page/user-list-page.component\";\r\nimport {UsersModule} from \"../../features/users/users.module\";\r\nimport {MatButtonModule} from \"@angular/material/button\";\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    UserListPageComponent,\r\n    UserViewPageComponent\r\n  ],\r\n    imports: [\r\n        CommonModule,\r\n        UsersPageRoutingModule,\r\n        UsersModule,\r\n        MatButtonModule\r\n    ]\r\n})\r\nexport class UsersPageModule {\r\n}\r\n"]}